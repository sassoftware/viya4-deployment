---
- name: Create tmpdir
  tempfile:
    state: directory
  register: tmpdir
  tags:
    - install
    - uninstall
    - upgrade

# - name: Download viya4-monitoring-kubernetes
#   git:
#     repo: https://github.com/sassoftware/viya4-monitoring-kubernetes.git
#     dest: "{{ tmpdir.path }}"
#     version: 0.1.0
#   tags:
#     - install
#     - uninstall
#     - upgrade

- name: Include cluster monitoring
  include_tasks: cluster-monitoring.yaml
  tags:
    - cluster-monitoring

- name: Include viya monitoring
  include_tasks: viya-monitoring.yaml
  tags:
    - viya-monitoring

- name: Include cluster logging
  include_tasks: cluster-logging.yaml
  tags:
    - cluster-logging

- name: Delete tmpdir
  file:
    path: "{{ tmpdir.path }}"
    state: absent
  tags:
    - install
    - update
    - uninstall