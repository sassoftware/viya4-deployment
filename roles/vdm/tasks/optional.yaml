---
- name: optional - elasticsearch
  overlay_facts:
    cadence_name: "{{ V4_CFG_CADENCE_NAME }}"
    cadence_number: "{{ V4_CFG_CADENCE_VERSION }}"
    existing: "{{ vdm_overlays }}"
    add:
      - { resources: "overlays/internal-elasticsearch" }
      - { transformers: "overlays/internal-elasticsearch/internal-elasticsearch-transformer.yaml" }
      - { transformers: "overlays/internal-elasticsearch/sysctl-transformer.yaml", priority: 55 }
  when:
    - ( V4_CFG_ELASTICSEARCH_ENABLE is not none and V4_CFG_ELASTICSEARCH_ENABLE) or ( V4_CFG_CADENCE_VERSION | version_compare('2020.1.3', '>=' )
  tags:
    - install
    - uninstall
    - upgrade