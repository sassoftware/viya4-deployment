---
- name: Configure load balancer for SAS/CONNECT
  include_tasks: vdm_loader.yaml
  vars:
    resources: 
      - "{{ VDM_RESOURCES_PATH }}/sas-connect-spawner-enable-loadbalancer.yaml"
  when: 
    - V4_CFG_ENABLE_CONNECT_LOADBALANCER
  tags:
    - install
    - uninstall
    - upgrade

- name: Add SAS/CONNECT FQDN to the SAN DNS list for cert-manager
  set_fact:
    V4_CFG_CERT_MANAGER_CERTIFICATE_ADDITIONAL_SAN_DNS: "{{V4_CFG_CERT_MANAGER_CERTIFICATE_ADDITIONAL_SAN_DNS}} {{V4_CFG_CONNECT_FQDN}}"
  when:
    - V4_CFG_CONNECT_FQDN is not none
  tags:
    - install
    - uninstall
    - upgrade
